<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>Loading... ‚Äì K1llajay</title> <!-- Will be updated dynamically -->
  <link rel="icon" href="favicon.ico">
  <style>
@font-face {
  font-family: 'sitefont';
  src: url('beyoncefont.ttf') format('truetype');
}

/* ================= RESET ================= */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  width: 100%;
  height: 100dvh;
  font-family: 'sitefont', monospace;
  text-transform: uppercase;
  color: white;
}

html, body {
  padding-top: 18px;
}

html {
  height: 100vh;
  height: 100dvh;
  padding-top: 18px;
}

/* ================= INFINITE BACKGROUND ================= */
body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  height: 100dvh;
  background: url("IMG_3309.gif") center / cover no-repeat;
  background-attachment: fixed;
  z-index: -2;
}

body::after {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  height: 100dvh;
  background: rgba(0,0,0,0.65);
  z-index: -1;
}

/* ================= BODY ================= */
body {
  display: flex;
  min-height: 100dvh;
  position: relative;
  overflow: hidden;
}

/* ================= SIDEBAR ================= */
.sidebar {
  width: 260px;
  height: 100dvh;
  padding: 24px;
  position: fixed;
  left: 0;
  top: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  backdrop-filter: blur(10px);
  border-right: 1px solid rgba(255,255,255,0.15);
  z-index: 3000;
}

.profile-img {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid white;
  margin-bottom: 20px;
}

.name {
  font-size: 22px;
  letter-spacing: 3px;
  margin-bottom: 40px;
}

.buttons {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.button {
  padding: 10px;
  text-align: center;
  text-decoration: none;
  color: white;
  font-size: 13px;
  letter-spacing: 2px;
  border: 1px solid rgba(255,255,255,0.4);
  transition: border-color 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), color 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1;
  will-change: border-color, color;
}

.button::before {
  content: "";
  position: absolute;
  inset: 0;
  background: url('Soulaan-flag-v0-26ghsv12s7cb1.webp') center / cover no-repeat;
  filter: brightness(0.4);
  border-radius: inherit;
  z-index: -1;
  transition: filter 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  will-change: filter;
}

.button:hover::before {
  filter: brightness(1);
}

.button:hover {
  border-color: white;
}

.footer {
  margin-top: auto;
  font-size: 10px;
  opacity: 0.7;
  text-align: center;
}

.footer a {
  color: white;
  text-decoration: none;
}

.copyright {
  font-size: 8px;
  margin-top: 6px;
}

/* ================= TOP BAR (MOBILE) ================= */
.topbar {
  display: none;
}

/* Main Content (Desktop) */
.main-content::-webkit-scrollbar { display: none; }
.main-content { -ms-overflow-style: none; scrollbar-width: none; }
.main-content {
  margin-left: 260px;
  flex: 1;
  min-height: calc(100dvh - 35px);
  overflow-y: auto;
  padding: 20px;      
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  contain: none;
}

#album-title-section {
  text-align: center;
  margin-bottom: 60px;
}

#album-title {
  font-size: 36px;
  letter-spacing: 1px;
  margin-bottom: 20px;
}

.credits-button {
  display: inline-block;
  padding: 10px 24px;
  font-size: 12px;
  letter-spacing: 2px;
  border: 1px solid rgba(255,255,255,0.4);
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(18px);
}

.credits-button:hover {
  background: rgba(255,255,255,0.1);
  border-color: white;
}

.disc-header {
  text-align: center;
  font-size: 14px;
  letter-spacing: 4px;
  opacity: 0.7;
  margin: 60px 0 30px;
}

.tracklist {
  max-width: 800px;
  margin: 0 auto;
  font-size: 16px;
  line-height: 2.4;
}

.track {
  display: flex;
  gap: 20px;
  cursor: pointer;
  transition: opacity 0.2s ease;
}

.track:hover {
  opacity: 0.7;
}

.track-number {
  width: 40px;
  text-align: right;
  opacity: 0.6;
}

.track-dash {
  opacity: 0.6;
}

/* Lyrics/Credits Overlay */
#overlay {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 260px;
  right: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 100;
  margin-left: 20px;
  margin-right: 20px;
  margin-top: 35px;
}

#overlay::before {
  content: "";
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background: url("IMG_3309.gif") center / cover no-repeat;
  z-index: -2;
}

#overlay::after {
  content: "";
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background: rgba(0,0,0,0.65);
  z-index: -1;
}

#overlay.active {
  display: flex;
}

#overlayContent {
  position: relative;
  padding: 30px 20px;
  border-radius: 12px;
  max-width: 90%;
  width: 100%;
  height: 80vh;
  overflow-y: auto;
  border: 1px solid rgba(255,255,255,0.2);
  backdrop-filter: blur(9px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
}

#overlayContent::-webkit-scrollbar {
  display: none;
}

#overlayContent {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

#overlayContent h1 {
  font-size: 18px;
  text-align: center;
  letter-spacing: 0.5px;
  line-height: 1.8;
}

#overlayContent h3 {
  font-size: 17px;
  text-align: center;
  letter-spacing: 0.5px;
  line-height: 1.8;
}

.overlay-close {
  position: sticky;
  top: 10px;
  right: 10px;
  align-self: flex-end;
  margin-bottom: -40px;
  z-index: 12;
  background: none;
  border: none;
  font-size: 28px;
  color: white;
  cursor: pointer;
  opacity: 0.7;
}

.overlay-close:hover {
  opacity: 1;
}

.track-header {
  position: sticky;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 0px;
  width: 100%;
  top: 0;
  z-index: 10;
  padding-top: 15px;
  padding-bottom: 15px;
}

.track-info {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.next-track-btn, .prev-track-btn {
  padding: 12px 18px;
  font-size: 18px;
  letter-spacing: 2px;
  border: 1px solid rgba(255,255,255,0.4);
  background: rgba(0,0,0,0.4);
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.next-track-btn:hover, .prev-track-btn:hover {
  background: rgba(255,255,255,0.1);
  border-color: white;
}

.next-track-btn:disabled, .prev-track-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  background: rgba(0,0,0,0.2);
  border-color: rgba(255,255,255,0.2);
}

.next-track-btn:disabled:hover, .prev-track-btn:disabled:hover {
  background: rgba(0,0,0,0.2);
  border-color: rgba(255,255,255,0.2);
}

.sub-toggle {
  position: sticky;
  display: flex;
  justify-content: center;
  gap: 40px;
  margin-bottom: 30px;
  top: 95px;
  z-index: 9;
  padding-top: 10px;
  padding-bottom: 10px;
}

.sub-toggle span {
  font-size: 14px;
  letter-spacing: 2px;
  padding: 8px 16px;
  cursor: pointer;
  opacity: 0.6;
  border-bottom: 2px solid transparent;
}

.sub-toggle span.activeTab {
  opacity: 1;
  border-bottom: 2px solid white;
}

.tab-content {
  display: none;
  line-height: 1.8;
  font-size: 16px;
}

#lyrics {
  mask-image: linear-gradient(to bottom, transparent 0px, transparent 140px, black 180px, black 100%);
  -webkit-mask-image: linear-gradient(to bottom, transparent 0px, transparent 140px, black 180px, black 100%);
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
  mask-position: 0 var(--tab-mask-offset, 0px);
  -webkit-mask-position: 0 var(--tab-mask-offset, 0px);
}

.tab-content.activeTab {
  display: block;
}

.service-logos {
  margin-top: 30px;
  padding-top: 30px;
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-bottom: 30px;
}

.service-logos img {
  height: 40px;
  opacity: 0.8;
  transition: opacity 0.3s;
}

.service-logos img:hover {
  opacity: 1;
}

/* Full Album Credits Modal */
.song-modal {
  position: fixed;
  top: 35px;
  bottom: 20px;
  left: 260px;
  right: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 101;
}

.song-modal::before {
  content: "";
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background: url("IMG_3309.gif") center / cover no-repeat;
  z-index: -2;
}

.song-modal::after {
  content: "";
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background: rgba(0,0,0,0.65);
  z-index: -1;
}

.song-modal.open {
  display: flex;
}

.song-modal .container {
  position: relative;
  padding: 50px;
  max-width: calc(100% - 40px);
  width: calc(100% - 40px);
  max-height: 80vh;
  overflow-y: auto;
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 12px;
  text-align: center;
  backdrop-filter: blur(9px);
}

.song-modal .container::-webkit-scrollbar {
  display: none;
}

.song-modal .container {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.album-info-header {
  position: sticky;
  top: 0;
  z-index: 10;
}

#album-credits-body {
  mask-image: none;
  -webkit-mask-image: none;
}

#album-credits-body.mask-active {
  mask-image: linear-gradient(to bottom, transparent 0px, transparent 130px, black 170px, black 100%);
  -webkit-mask-image: linear-gradient(to bottom, transparent 0px, transparent 130px, black 170px, black 100%);
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
  mask-position: 0 var(--album-mask-offset, 0px);
  -webkit-mask-position: 0 var(--album-mask-offset, 0px);
}

#album-credits-body.no-mask {
  mask-image: none;
  -webkit-mask-image: none;
}

.song-modal h1 {
  font-size: 25px;
  letter-spacing: 1px;
  margin-bottom: 10px;
}

.song-modal h3 {
  font-size: 20px;
  margin: 30px 0 15px;
  letter-spacing: 1px;
}

.song-modal p {
  font-size: 15px;
  line-height: 1.8;
  opacity: 0.9;
  margin-bottom: 20px;
}

.modal-close {
  position: fixed;
  top: 20px;
  right: 30px;
  z-index: 106;
  background: none;
  border: none;
  font-size: 28px;
  color: white;
  cursor: pointer;
  opacity: 0.7;
}

.track-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 0px;
  width: 100%;
}

.track-info {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.next-track-btn, .prev-track-btn {
  padding: 12px 18px;
  font-size: 18px;
  letter-spacing: 2px;
  border: 1px solid rgba(255,255,255,0.4);
  background: rgba(0,0,0,0.4);
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.next-track-btn:hover, .prev-track-btn:hover {
  background: rgba(255,255,255,0.1);
  border-color: white;
}

.next-track-btn:disabled, .prev-track-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  background: rgba(0,0,0,0.2);
  border-color: rgba(255,255,255,0.2);
}

.next-track-btn:disabled:hover, .prev-track-btn:disabled:hover {
  background: rgba(0,0,0,0.2);
  border-color: rgba(255,255,255,0.2);
}

/* Mobile */
@media (max-width: 768px) {
  body {
    flex-direction: column;
    padding-top: 35px;
  }

  body.sidebar-open {
    overflow: hidden;
  }

  .topbar {
    display: flex;
    position: fixed;
    top: 35px;
    left: 0;
    width: 100%;
    height: 50px;
    padding: 0 15px;
    padding-top: max(0px, env(safe-area-inset-top));
    align-items: center;
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255,255,255,0.15);
    z-index: 2101;
  }

  .hamburger {
    font-size: 28px;
    cursor: pointer;
    padding: 5px;
  }

  .top-name {
    margin: 0 auto;
    font-size: 16px;
    letter-spacing: 2px;
  }

  .sidebar {
    display: none;
    position: fixed;
    top: 85px;
    left: 0;
    width: 100%;
    height: calc(100dvh - 85px);
    z-index: 1900;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .sidebar.active {
    display: flex;
  }

  .main-content {
    margin-left: 0;
    width: 100%;
    height: auto;
    min-height: calc(100dvh - 85px);
    padding: 16px;
    padding-top: 100px;
    padding-bottom: max(40px, calc(16px + env(safe-area-inset-bottom)));
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
  }

  .main-content > * {
    width: 100%;
    max-width: 100%;
  }

  .sidebar.active ~ .main-content {
    overflow: hidden;
  }

  #album-title-section {
    margin-bottom: 24px;
    text-align: center;
    width: 100%;
  }

  #album-title {
    margin-top: 20px;
    font-size: 24px;
  }

  .disc-header {
    margin: 20px 0 12px;
    font-size: 12px;
  }

  .tracklist {
    font-size: 13px;
    line-height: 1.8;
    width: 100%;
    max-width: 100%;
  }

  .service-logos img {
    height: 32px;
  }

  .song-modal .container {
    padding: 24px 16px;
  }

  #album-credits-body.mask-active {
    mask-image: linear-gradient(to bottom, transparent 0px, transparent 105px, black 140px, black 100%);
    -webkit-mask-image: linear-gradient(to bottom, transparent 0px, transparent 105px, black 140px, black 100%);
  }

  .song-modal {
    top: 85px;
    bottom: 10px;
    left: 0;
    right: 0;
  }

  .song-modal .container {
    max-width: calc(100% - 20px);
    width: calc(100% - 20px);
  }

  .track-header {
    flex-wrap: wrap;
    gap: 12px;
  }

  .next-track-btn, .prev-track-btn {
    min-width: 44px;
    height: 44px;
    font-size: 16px;
  }

  #overlay {
    left: 0;
    margin-left: 10px;
    margin-right: 10px;
    margin-top: 85px;
  }

  #overlayContent {
    position: relative;
    padding: 20px 16px 20px;
    border-radius: 8px;
    max-width: 100%;
    width: 100%;
    max-height: calc(100dvh - 100px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    border: 1px solid rgba(255,255,255,0.2);
    backdrop-filter: blur(9px);
  }

  #overlayContent h1 {
    font-size: 18px;
  }

  #overlayContent h3 {
    font-size: 14px;
  }

  .overlay-close {
    top: 8px;
    right: 8px;
  }

  .sub-toggle {
    gap: 8px;
    margin-bottom: 16px;
  }

  .sub-toggle span {
    font-size: 11px;
    padding: 4px 8px;
  }

  .tab-content {
    font-size: 12px;
    line-height: 1.6;
    text-align: left;
  }

  #lyrics {
    mask-image: linear-gradient(to bottom, transparent 0px, transparent 100px, black 140px, black 100%);
    -webkit-mask-image: linear-gradient(to bottom, transparent 0px, transparent 100px, black 140px, black 100%);
  }

  .service-logos {
    gap: 12px;
    margin-top: auto;
    margin-bottom: 16px;
  }
}

/* ================= BLACK HISTORY MONTH BANNER ================= */
.bhm-banner {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  width: 100%;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2100;
  overflow: hidden;
  box-shadow: none;
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.15);
}

.bhm-banner::before {
  content: "";
  position: absolute;
  inset: 0;
  backdrop-filter: blur(10px);
  z-index: 1;
}

.bhm-text {
  position: relative;
  z-index: 2;
  color: white;
  font-size: 20px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 4px;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.8);
  white-space: nowrap;
  animation: scrollBanner 20s linear infinite;
}

@keyframes scrollBanner {
  0% { transform: translateX(100vw); }
  100% { transform: translateX(-100vw); }
}

@media (max-width: 768px) {
  html, body {
    padding-top: 0;
  }
}
  </style>
</head>
<body>
  <!-- MOBILE TOP BAR -->
  <div class="topbar">
    <div class="hamburger">‚ò∞</div>
    <div class="top-name">JAE LAURENT</div>
  </div>

  <!-- BLACK HISTORY MONTH BANNER -->
  <div class="bhm-banner">
    <div class="bhm-text">HAPPY BLACK HISTORY MONTH!!!!!!!!!!</div>
  </div>

  <!-- SIDEBAR -->
  <div class="sidebar">
    <img src="IMG_3214.JPEG" class="profile-img" alt="JAE LAURENT">
    <div class="name">
      <a href="https://k1llajay.com/mylinks" style="color:white;text-decoration:none;">JAE LAURENT</a>
    </div>

    <div class="buttons">
      <a href="https://k1llajay.com" class="button">Home</a>
      <a href="https://k1llajay.com/portfolio" class="button">Portfolio</a>
      <a href="https://k1llajay.com/podcast" class="button">Podcast</a>
      <a href="https://k1llajay.com/player" class="button">All Releases</a>
      <a href="https://k1llajay.com/music-database" class="button">Music Database</a>
      <a href="https://k1llajay.com/events" class="button">Events</a>
      <a href="https://k1llajay.com/memes" class="button">Memes & Videos</a>
      <a href="https://k1llajay.com/404" class="button">COMING SOON</a>
    </div>

    <div class="footer">
      <a href="https://mystery.k1llajay.com">Mystery</a> ‚Ä¢
      <a href="https://k1llajay.com/edit-music_editor">Upload</a> ‚Ä¢
      <a href="https://k1llajay.com/terms">Terms</a> ‚Ä¢
      <a href="https://k1llajay.com/privacy">Privacy</a>
      <div class="copyright">¬© 2025 Jefferson Entertainment LLC</div>
    </div>
  </div>

  <main class="main-content">
    <section id="album-title-section">
      <div id="album-title">Loading...</div>
      <div class="credits-button" onclick="openCredits()">CREDITS</div>
    </section>

    <div class="tracklist" id="tracklist">
      <!-- Tracks loaded dynamically -->
    </div>
  </main>

  <!-- Lyrics/Credits Overlay -->
  <aside id="overlay">
    <div id="overlayContent">
      <button class="overlay-close" onclick="closeOverlay()" aria-label="Close">X</button>
      <div class="track-header">
        <button id="prevTrackBtn" class="prev-track-btn" onclick="prevTrack()" disabled>‚Üê</button>
        <div class="track-info">
          <h1 id="title" class="track-title">Loading...</h1>
          <h3 id="artist" class="track-artist">By Loading...</h3>
        </div>
        <button id="nextTrackBtn" class="next-track-btn" onclick="nextTrack()">‚Üí</button>
      </div>
      <div class="sub-toggle">
        <span id="lyricsTab" class="activeTab" onclick="switchTab('lyrics')">LYRICS</span>
        <span id="creditsTab" onclick="switchTab('credits')">CREDITS</span>
      </div>
      <div id="lyrics" class="tab-content activeTab"><div>Loading...</div></div>
      <div id="credits" class="tab-content"><p>Loading...</p></div>
      <div class="service-logos">
        <a id="link-apple" href="#" target="_blank"><img src="apple.svg" alt="Apple Music"></a>
        <a id="link-spotify" href="#" target="_blank"><img src="spotify.svg" alt="Spotify"></a>
        <a id="link-amazon" href="#" target="_blank"><img src="amazon.svg" alt="Amazon Music"></a>
        <a id="link-tidal" href="#" target="_blank"><img src="tidal.svg" alt="Tidal"></a>
      </div>
    </div>
  </aside>

  <!-- Full Album Credits Modal -->
  <aside class="song-modal" id="creditsModal" aria-hidden="true">
    <div class="container" id="album-credits-container">
      <button class="modal-close" onclick="closeCredits()" aria-label="Close credits">X</button>
      <div class="album-info-header">
        <h1 id="album-credits-title">Loading...</h1>
        <h3 id="album-credits-artist">BY Loading...</h3>
        <br><hr><br>
      </div>
      <div id="album-credits-body">Loading...</div>
    </div>
  </aside>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyDf2Caujz2FQuUDtzDr8eArpmaHXX_vsVY",
      authDomain: "music-database-3ee0a.firebaseapp.com",
      databaseURL: "https://music-database-3ee0a-default-rtdb.firebaseio.com",
      projectId: "music-database-3ee0a",
      storageBucket: "music-database-3ee0a.firebasestorage.app",
      messagingSenderId: "148257189959",
      appId: "1:148257189959:web:3e52404367191d5835c162"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const albumRef = db.ref('album');
    const tracksRef = db.ref('tracks');
    const overlayContentEl = document.getElementById('overlayContent');
    const albumCreditsContainerEl = document.getElementById('album-credits-container');

    let albumData = { title: 'SOS', artist: 'Jae Laurent' };
    let trackData = {};
    let trackKeys = [];
    let currentTrackIndex = 0;

    function renderAlbumCreditsFromTracks() {
      const albumCreditsBodyEl = document.getElementById('album-credits-body');
      const albumCreditsTitleEl = document.getElementById('album-credits-title');
      if (!albumCreditsBodyEl) return;

      albumCreditsBodyEl.classList.toggle('no-mask', trackKeys.length <= 1);
      albumCreditsBodyEl.classList.remove('mask-active');

      const hasExplicitTrack = trackKeys.some(key => Boolean(trackData[key]?.explicit));
      const albumExplicitSymbol = hasExplicitTrack ? ' üÑ¥' : '';
      if (albumCreditsTitleEl) {
        albumCreditsTitleEl.textContent = `${albumData.title || 'SOS'}${albumExplicitSymbol}`;
      }

      if (!trackKeys.length) {
        albumCreditsBodyEl.innerHTML = albumData.credits || '<p>No credits available</p>';
        syncAlbumCreditsMaskToScroll();
        return;
      }

      const html = trackKeys.map(key => {
        const track = trackData[key] || {};
        const trackNumber = track.number || '?';
        const trackTitle = track.title || 'Untitled';
        const explicitSymbol = track.explicit ? ' üÑ¥' : '';

        let creditsHtml = '';
        if (track.credits) {
          creditsHtml = track.credits;
        } else {
          const creditsArr = [];
          if (track.creditPerformed) creditsArr.push(`PERFORMED BY ${track.creditPerformed}`);
          if (track.creditWritten) creditsArr.push(`WRITTEN BY ${track.creditWritten}`);
          if (track.creditMixed) creditsArr.push(`MIXED BY ${track.creditMixed}`);
          if (track.creditRecorded) creditsArr.push(`RECORDED BY ${track.creditRecorded}`);
          if (track.creditProduced) creditsArr.push(`PRODUCED BY ${track.creditProduced}`);
          if (track.creditSampled) creditsArr.push(`SAMPLED FROM ${track.creditSampled}`);
          creditsHtml = creditsArr.length ? `<p>${creditsArr.join(' / ')}</p>` : '<p>No credits available</p>';
        }

        return `
          <h3>${trackNumber}. ${trackTitle}${explicitSymbol}</h3>
          ${creditsHtml}
        `;
      }).join('');

      albumCreditsBodyEl.innerHTML = html;
      syncAlbumCreditsMaskToScroll();
    }

    // Update page title dynamically
    function updatePageTitle() {
      const title = albumData.title || 'SOS';
      document.title = `${title} ‚Äì K1llajay`;
    }


    // Load album data
    albumRef.on('value', snap => {
      albumData = snap.val() || { title: 'SOS', credits: '<p>Default credits...</p>', artist: 'Jae Laurent' };
      document.getElementById('album-title').textContent = albumData.title;
      document.getElementById('album-credits-artist').textContent = `BY ${albumData.artist}`;
      renderAlbumCreditsFromTracks();
      updatePageTitle();
    });

    // Load tracks (sort by number)
    tracksRef.on('value', snap => {
      const val = snap.val() || {};
      // Sort both keys and tracks by track number
      const entries = Object.entries(val).map(([k, v]) => [k, v]);
      entries.sort((a, b) => (a[1].number || 0) - (b[1].number || 0));
      trackKeys = entries.map(([k]) => k);
      trackData = {};
      entries.forEach(([k, v]) => { trackData[k] = v; });
      renderAlbumCreditsFromTracks();
      renderTracklist();
    });

    function renderTracklist() {
      const tracklist = document.getElementById('tracklist');
      tracklist.innerHTML = '';
      trackKeys.forEach(key => {
        const track = trackData[key];
        const explicitSymbol = track.explicit ? ' üÑ¥' : '';
        tracklist.innerHTML += `
          <div class="track">
            <div class="track-number">${track.number || '?' }.</div>
            <div class="track-title track-item" data-song="${key}">${track.title || 'Untitled'}${explicitSymbol}</div>
            <div class="track-dash"> - </div>
            <div class="track-artist" data-song="${key}">${track.artist || 'Unknown'}</div>
          </div>
        `;
      });

      document.querySelectorAll('.track-item, .track-artist').forEach(el => {
        el.addEventListener('click', () => {
          const key = el.dataset.song;
          if (key) openSongOverlay(key);
        });
      });
    }

    function openSongOverlay(key) {
      currentTrackIndex = trackKeys.indexOf(key);
      updateOverlay(key);
      updateNavButtons();
      if (overlayContentEl) {
        overlayContentEl.scrollTop = 0;
      }
      syncTabMaskToOverlayScroll();
      document.getElementById('overlay').classList.add('active');
      document.body.classList.add('no-scroll');
      switchTab('lyrics');
    }

    function syncTabMaskToOverlayScroll() {
      if (!overlayContentEl) return;
      const lyricsEl = document.getElementById('lyrics');
      if (lyricsEl) {
        const maskOffset = overlayContentEl.scrollTop - lyricsEl.offsetTop;
        lyricsEl.style.setProperty('--tab-mask-offset', `${maskOffset}px`);
      }
    }

    function syncAlbumCreditsMaskToScroll() {
      if (!albumCreditsContainerEl) return;
      const albumCreditsBodyEl = document.getElementById('album-credits-body');
      if (!albumCreditsBodyEl) return;

      if (trackKeys.length <= 1 || albumCreditsBodyEl.classList.contains('no-mask')) {
        albumCreditsBodyEl.classList.remove('mask-active');
        albumCreditsBodyEl.style.setProperty('--album-mask-offset', '0px');
        return;
      }

      const scrollTop = albumCreditsContainerEl.scrollTop;
      if (scrollTop > 0) {
        albumCreditsBodyEl.classList.add('mask-active');
      } else {
        albumCreditsBodyEl.classList.remove('mask-active');
      }

      const maskOffset = scrollTop - albumCreditsBodyEl.offsetTop;
      albumCreditsBodyEl.style.setProperty('--album-mask-offset', `${maskOffset}px`);
    }

    function updateOverlay(key) {
      const data = trackData[key] || { title: 'Unknown', artist: 'Unknown', lyrics: 'Lyrics coming soon...', credits: 'Credits coming soon...', links: {} };
      const explicitSymbol = data.explicit ? ' üÑ¥' : '';
      document.getElementById('title').textContent = data.title + explicitSymbol;
      document.getElementById('artist').textContent = `By ${data.artist || 'Jae Laurent'}`;
      document.getElementById('lyrics').innerHTML = `<div>${(data.lyrics || '').replace(/\n/g, '<br>')}</div>`;
      // Show new credits structure if available
      if (data.credits) {
        document.getElementById('credits').innerHTML = data.credits;
      } else {
        let creditsArr = [];
        const performed = data.creditPerformed || 'Jae Laurent';
        const written = data.creditWritten || 'Jae Laurent';
        const mixed = data.creditMixed || 'Jae Laurent';
        const recorded = data.creditRecorded || 'Jae Laurent';
        const produced = data.creditProduced || 'Jae Laurent';
        if (performed) creditsArr.push(`PERFORMED BY ${performed}`);
        if (written) creditsArr.push(`WRITTEN BY ${written}`);
        if (mixed) creditsArr.push(`MIXED BY ${mixed}`);
        if (recorded) creditsArr.push(`RECORDED BY ${recorded}`);
        if (produced) creditsArr.push(`PRODUCED BY ${produced}`);
        if (data.creditSampled) creditsArr.push(`SAMPLED FROM ${data.creditSampled}`);
        document.getElementById('credits').innerHTML = creditsArr.length ? `<p>${creditsArr.join(' / ')}</p>` : '<p>No credits available</p>';
      }
      document.getElementById('link-apple').href = data.links?.apple || '#';
      document.getElementById('link-spotify').href = data.links?.spotify || '#';
      document.getElementById('link-amazon').href = data.links?.amazon || '#';
      document.getElementById('link-tidal').href = data.links?.tidal || '#';
    }

    function prevTrack() {
      if (currentTrackIndex > 0) {
        currentTrackIndex--;
        updateOverlay(trackKeys[currentTrackIndex]);
        updateNavButtons();
      }
    }

    function nextTrack() {
      if (currentTrackIndex < trackKeys.length - 1) {
        currentTrackIndex++;
        updateOverlay(trackKeys[currentTrackIndex]);
        updateNavButtons();
      }
    }

    function updateNavButtons() {
      document.getElementById('prevTrackBtn').disabled = currentTrackIndex === 0;
      document.getElementById('nextTrackBtn').disabled = currentTrackIndex === trackKeys.length - 1;
    }

    function switchTab(tab) {
      document.querySelectorAll('.sub-toggle span').forEach(el => el.classList.remove('activeTab'));
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('activeTab'));
      document.getElementById(`${tab}Tab`).classList.add('activeTab');
      document.getElementById(tab).classList.add('activeTab');
      if (overlayContentEl) {
        overlayContentEl.scrollTop = 0;
      }
      syncTabMaskToOverlayScroll();
    }

    function openCredits() {
      document.getElementById('creditsModal').classList.add('open');
      document.body.classList.add('no-scroll');
      if (albumCreditsContainerEl) {
        albumCreditsContainerEl.scrollTop = 0;
      }
      syncAlbumCreditsMaskToScroll();
    }

    function closeCredits() {
      document.getElementById('creditsModal').classList.remove('open');
      document.body.classList.remove('no-scroll');
    }

    function closeOverlay() {
      document.getElementById('overlay').classList.remove('active');
      document.body.classList.remove('no-scroll');
    }

    document.querySelector('.hamburger').onclick = () => {
      document.querySelector('.sidebar').classList.toggle('active');
      document.body.classList.toggle('sidebar-open');
    };

    if (overlayContentEl) {
      overlayContentEl.addEventListener('scroll', syncTabMaskToOverlayScroll, { passive: true });
    }

    if (albumCreditsContainerEl) {
      albumCreditsContainerEl.addEventListener('scroll', syncAlbumCreditsMaskToScroll, { passive: true });
    }

    // Initial title (will be updated once data loads)
    updatePageTitle();

    // Hide banner outside of February and June
    function checkSeasonalVisibility() {
      const now = new Date();
      const month = now.getMonth() + 1;
      const day = now.getDate();
      const isBlackHistoryMonth = month === 2 && day <= 28;
      const isPrideMonth = month === 6 && day <= 30;
      const shouldShow = isBlackHistoryMonth || isPrideMonth;
      const banner = document.querySelector(".bhm-banner");
      if (!shouldShow && banner) banner.style.display = "none";
    }
    
    checkSeasonalVisibility();
  </script>
</body>
</html>